## 揭秘 Actuator 的端点

Spring Boot Actuator的关键特性是在应用程序里提供众多Web端点，通过它们了解应用程序
运行时的内部状况。

有了Actuator：

- 可以知道Bean在Spring应用程序上下文里是如何组装在一
  起的
- 掌握应用程序可以获取的环境属性信息
- 获取运行时度量信息的快照……

### 引入Actuator

引入Actuator的起步依赖：

```xml
<dependency>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

Gradle构建：

```groovy
compile 'org.springframework.boot:spring-boot-starter-actuator'
```

使用Spring Boot CLI，可以使用如下 @Grab 注解：

```java
@Grab('spring-boot-starter-actuator')
```

#### 配置信息

```properties
# Spring Actuator Endpoints 默认关闭，需要打开
endpoints.enabled: true
# close security. 关闭身份验证，否则无法查询出数据
management.security.enabled=false
```

### Actuator的端点

[官方文档](https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html)

| HTTP 方法 | 路径            | 描述                                                         |
| --------- | --------------- | ------------------------------------------------------------ |
| GET       | /auditevents    | 显示应用暴露的审计事件 (比如认证进入、订单失败)              |
| GET       | /beans          | 描述应用程序上下文里全部的 Bean，以及它们的关系              |
| GET       | /conditions     | 提供一份自动配置生效的条件情况，记录哪些自动配置条件通过了   |
| GET       | /configprops    | 描述配置属性(包含默认值)如何注入Bean                         |
| GET       | /env            | 获取全部环境属性                                             |
| GET       | /env/{name}     | 根据名称获取特定的环境属性值                                 |
| GET       | /flyway         | 提供一份 Flyway 数据库迁移信息                               |
| GET       | /liquidbase     | 显示Liquibase 数据库迁移的纤细信息                           |
| GET       | /health         | 报告应用程序的健康指标，这些值由 HealthIndicator 的实现类提供 |
| GET       | /heapdump       | dump 一份应用的 JVM 堆信息                                   |
| GET       | /httptrace      | 显示HTTP足迹，最近100个HTTP request/repsponse                |
| GET       | /info           | 获取应用程序的定制信息，这些信息由info打头的属性提供         |
| GET       | /logfile        | 返回log file中的内容(如果 logging.file 或者 logging.path 被设置) |
| GET       | /loggers        | 显示和修改配置的loggers                                      |
| GET       | /metrics        | 报告各种应用程序度量信息，比如内存用量和HTTP请求计数         |
| GET       | /metrics/{name} | 报告指定名称的应用程序度量值                                 |
| GET       | /scheduledtasks | 展示应用中的定时任务信息                                     |
| GET       | /sessions       | 如果我们使用了 Spring Session 展示应用中的 HTTP sessions 信息 |
| POST      | /shutdown       | 关闭应用程序，要求endpoints.shutdown.enabled设置为true       |
| GET       | /mappings       | 描述全部的 URI路径，以及它们和控制器(包含Actuator端点)的映射关系 |
| GET       | /threaddump     | 获取线程活动的快照                                           |

### 查看配置明细

Actuator有一些端点不仅可以显示组件映射关系，还可以告诉你自动配置在配置
Spring应用程序上下文时做了哪些决策。

#### 获得Bean装配报告





